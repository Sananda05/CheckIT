{% extends 'src\Views\Exams\Exam_Base.html' %}
{% block HomeContent %}

<!--static-->
  {% load static %}
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
<!---->

<script type="text/javascript">
  // The Browser API key obtained from the Google API Console.
  // Replace with your own Browser API key, or your own key.
  var developerKey = 'AIzaSyDnsJcFdqMPV2knwlj-oPlxJa1KPyQ18kU';

  // The Client ID obtained from the Google API Console. Replace with your own Client ID.
  var clientId = "637334363994-g3qp5e1p801mr5ujgj3igqk2grd9dqkk.apps.googleusercontent.com"

  // Replace with your own project number from console.developers.google.com.
  // See "Project number" under "IAM & Admin" > "Settings"
  var appId = "637334363994";

  // Scope to use to access user's Drive items.
  var scope = ['https://www.googleapis.com/auth/drive.file'];

  var pickerApiLoaded = false;
  var oauthToken;

  // Use the Google API Loader script to load the google.picker script.
  function loadPicker() {
    gapi.load('auth', {'callback': onAuthApiLoad});
    gapi.load('picker', {'callback': onPickerApiLoad});
  }

  function onAuthApiLoad() {
    window.gapi.auth.authorize({
      'client_id': clientId,
      'scope': scope,
      'immediate': false
    },
    handleAuthResult);
  }

  function onPickerApiLoad() {
    pickerApiLoaded = true;
    createPicker();
  }

  function handleAuthResult(authResult) {
    if (authResult && !authResult.error) {
      oauthToken = authResult.access_token;
      createPicker();
    }
  }

  // Create and render a Picker object for searching images.
  function createPicker() {
    if (pickerApiLoaded && oauthToken) {
      var view = new google.picker.View(google.picker.ViewId.DOCS);
      view.setMimeTypes("image/png,image/jpeg,image/jpg");
      var picker = new google.picker.PickerBuilder()
        .enableFeature(google.picker.Feature.NAV_HIDDEN)
        .enableFeature(google.picker.Feature.MULTISELECT_ENABLED)
        .setAppId(appId)
        .setOAuthToken(oauthToken)
        .addView(view)
        .addView(new google.picker.DocsUploadView())
        .setDeveloperKey(developerKey)
        .setCallback(pickerCallback)
        .build();
      picker.setVisible(true);

      var elements= document.getElementsByClassName('picker-dialog');
      for(var i=0; i<elements.length; i++){
        elements[i].style.zIndex = "2000";
      }
    }
  }

  // A simple callback implementation.
  function pickerCallback(data) {
    if (data.action == google.picker.Action.PICKED) {
      var fileId = data.docs[0].url;
      var title = data.docs[0].name;
      var element = document.getElementById('drive_pdf');
      var element1 = document.getElementById('drive_pdf_title');
      
      element.disabled = false;
      element.value = fileId;
      element1.value = title;
      //alert('The user selected: ' + fileId);
    }
  }
</script>

<div class="page-wrapper mdc-toolbar-fixed-adjust">
  <main class="content-wrapper">
    <div class="mdc-layout-grid__inner">
      <form action="" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal" tabindex="-1" id="newFolder">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Add New File</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <br>
                <div class="input-group">
                  <input type="file" multiple name ="exam_file" class="form-control" id="inputGroupFile04" 
                    aria-describedby="inputGroupFileAddon04" aria-label="Upload">
                </div>
                <br>
                <div>
                  <label for="exam_name" style="padding-left: 8px; padding-top: 10px; padding-bottom: 5px;">
                    Or Add from drive
                  </label>
                </div>
                <div class="row">
                  <div class="col-md-10">
                  <div class="mdc-layout-grid__cell stretch-card mdc-layout-grid__cell--span-4-desktop">
                    <div class="mdc-text-field mdc-text-field--outlined">
                      <input class="mdc-text-field__input" id="drive_pdf" name="drive_pdf" disabled style="padding-right: 0px;">
                      <input class="mdc-text-field__input" type="hidden" id="drive_pdf_title" name="drive_pdf_title" style="padding-right: 0px;">
                      <div class="mdc-notched-outline">
                        <div class="mdc-notched-outline__leading"></div>
                        <div class="mdc-notched-outline__notch">
                          <label for="exam_name" class="mdc-floating-label">
                            
                          </label>    
                        </div>
                        <div class="mdc-notched-outline__trailing"></div>
                      </div>
                    </div>
                  </div>
                  </div>
                  <div class="col-md-2" style="padding-top:3px;">
                    <button type="button" onclick="showPickerDialog()" class="mdc-button" style="padding-left: 0px; padding-right: 0px;">
                      <img src="{% static "Assets/drive.png" %}" style="length: 30px; height: 30px;" data-toggle="tooltip" title="Add Attachments" alt="user" class="user">
                    </button>
                  </div>
                </div>
                  <!-- The Google API Loader script. -->
                  <script type="text/javascript" src="https://apis.google.com/js/api.js"></script>
                  <script>
                    function showPickerDialog(){
                      loadPicker()
                    }
                  </script>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-sm btn-outline-dark" data-bs-dismiss="modal">Close</button>
                <input type="submit" value="Create" class="btn btn-primary">
              </div>
            </div>
          </div>
        </div>
      </form>
</div>

<div class="page-wrapper mdc-toolbar-fixed-adjust">
  <main class="content-wrapper" style=" padding-top: 0px; padding-bottom: 0px;">
  <h5 style = "padding-bottom: 10px;"> Unchecked Scripts</h5>
    <div class="mdc-layout-grid__inner">
      {% if examScripts %}
        {% for examScript, file_name in zipped_lists %}
          {% if examScript.title == ''%}
          <div class="mdc-layout-grid__cell stretch-card mdc-layout-grid__cell--span-3-desktop mdc-layout-grid__cell--span-4-tablet">
            <div class="mdc-card info-card info-card--warning">
              <div class="card-inner">
                <a href = "{{ examScript.id }}/" style = "text-decoration: None;"><h4 class="card-title">{{ file_name }}</h4></a>
                
                <div class="mdc-layout-grid__cell stretch-card mdc-layout-grid__cell--span-2 text-muted tx-14">
                  {{ file_name }}
                </div>
                
                <div class="card-icon-wrapper">
                  <i class="material-icons">description</i>
                </div>
              </div>
            </div>  
          </div>
          {% else %}
          <div class="mdc-layout-grid__cell stretch-card mdc-layout-grid__cell--span-3-desktop mdc-layout-grid__cell--span-4-tablet">
            <div class="mdc-card info-card info-card--warning">
              <div class="card-inner">
                <a href = "{{ examScript.id }}/" style = "text-decoration: None;"><h4 class="card-title">{{ examScript.title }}</h4></a>
                
                <div class="mdc-layout-grid__cell stretch-card mdc-layout-grid__cell--span-2 text-muted tx-14">
                  {{ examScript.title }}
                </div>
                
                <div class="card-icon-wrapper">
                  <i class="material-icons">description</i>
                </div>
              </div>
            </div>  
          </div>
          {% endif %}
        {% endfor %}
      {% else %}
        <div class="mdc-layout-grid__cell stretch-card mdc-layout-grid__cell--span-3-desktop mdc-layout-grid__cell--span-4-tablet">
          <div class="mdc-card info-card info-card--warning">
            <div class="card-inner">
              No Unchecked Scripts. Add one Now!
            </div>
          </div>  
        </div>
      {% endif %}
    </div>
    <br>
    <br>
    <div class="mdc-layout-grid__cell stretch-card mdc-layout-grid__cell--span-3-desktop mdc-layout-grid__cell--span-4-tablet">
      <h5 style = "padding-bottom: 10px; padding-top: 30px; floating: left;">
        Checked Scripts &nbsp &nbsp
        <a href="/home/{{ courses.name }}/{{ exam.exam_name }}/export_excel" class="mdc-button mdc-button--raised icon-button">
          <img src="{% static "Assets/excel.png" %}" style="length: 20px; height: 20px;" data-toggle="tooltip" title="Export to Excel" alt="user" class="user">
        </a>
      </h5>
    </div>
    <div class="mdc-layout-grid__inner">
      {% if checkedExamScripts %}
        {% for checkedExamScripts, checked_file_names in zipped_lists_2 %}
        {% if checkedExamScripts.title == ''%}
          <div class="mdc-layout-grid__cell stretch-card mdc-layout-grid__cell--span-3-desktop mdc-layout-grid__cell--span-4-tablet">
            <div class="mdc-card info-card info-card--warning">
              <div class="card-inner">
                <a href = "Script{{ checkedExamScripts.id }}/Review/" style = "text-decoration: None;"><h5 class="card-title">{{ checkedExamScripts.student_id }}</h5></a>
                <h5 class="font-weight-light pb-2 mb-1 border-bottom">{{ checkedExamScripts.student_id }}.pdf</h5>
                
                <div class="card-icon-wrapper" style="width: 100px;">
                  <h3 style = "color: white;">{{ checkedExamScripts.Marks }}</h3>
                </div>
              </div>
            </div>  
          </div>
        {% else %}
          <div class="mdc-layout-grid__cell stretch-card mdc-layout-grid__cell--span-3-desktop mdc-layout-grid__cell--span-4-tablet">
            <div class="mdc-card info-card info-card--warning">
              <div class="card-inner">
                <a href = "Script{{ checkedExamScripts.id }}/Review/" style = "text-decoration: None;"><h5 class="card-title">{{ checkedExamScripts.student_id }}</h5></a>
                <h5 class="font-weight-light pb-2 mb-1 border-bottom">{{ checkedExamScripts.student_id }}.pdf</h5>
                
                <div class="card-icon-wrapper" style="width: 100px;">
                  <h3 style = "color: white;">{{ checkedExamScripts.Marks }}</h3>
                </div>
              </div>
            </div>  
          </div>
        {% endif %}
        {% endfor %}
      {% else %}
        <div class="mdc-layout-grid__cell stretch-card mdc-layout-grid__cell--span-3-desktop mdc-layout-grid__cell--span-4-tablet">
          <div class="mdc-card info-card info-card--warning">
            <div class="card-inner">
              No Checked Scripts. Check one Now!
            </div>
          </div>  
        </div>
      {% endif %}
    </div>  
  </main>
</div>
{% endblock %}